<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>niliushall</title><meta name="author" content="niliushall"><meta name="copyright" content="niliushall"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="website">
<meta property="og:title" content="niliushall">
<meta property="og:url" content="https://www.wangliang.ml/index.html">
<meta property="og:site_name" content="niliushall">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.wangliang.ml/img/niliushall.png">
<meta property="article:author" content="niliushall">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.wangliang.ml/img/niliushall.png"><link rel="shortcut icon" href="/img/niliushall.png"><link rel="canonical" href="https://www.wangliang.ml/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'niliushall',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2023-03-30 16:07:19'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="niliushall" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/niliushall.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/img/index.png')"><nav id="nav"><span id="blog-info"><a href="/" title="niliushall"><img class="site-icon" src="/img/niliushall.png"/><span class="site-name">niliushall</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">niliushall</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/niliushall" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:niliushall@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2023/03/30/Python%E6%97%A5%E5%BF%97%E5%BA%93logging/" title="Python日志库logging"><img class="post-bg" src="http://cdn-hw-static.shanhutech.cn/bizhi/staticwp/202212/13746e6880e009d49378a81f0dec5474--569975149.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python日志库logging"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/03/30/Python%E6%97%A5%E5%BF%97%E5%BA%93logging/" title="Python日志库logging">Python日志库logging</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-30T07:33:05.000Z" title="发表于 2023-03-30 15:33:05">2023-03-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Python/">Python</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Python/">Python</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/logging/">logging</a></span></div><div class="content">1. logging日志库参考：
logging官方文档
python logging模块使用教程 - 简书
python日志：logging模块使用 - 知乎
1.1 日志类型


Level
When it’s used



DEBUG
Detailed information, typically of interest only when diagnosing problems.


INFO
Confirmation that things are working as expected.


WARNING
An indication that something unexpected happened, or indicative of some problem in the near future (e.g. ‘disk space low’). The software is still working as expected.


ERROR
Due to a more serious problem, the software has not been able ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/03/30/%E5%B7%A6%E7%A8%8B%E4%BA%91%E7%AE%97%E6%B3%95%E8%AF%BE%E7%AC%94%E8%AE%B0/" title="左程云算法课笔记"><img class="post-bg" src="http://browser9.qhimg.com/bdm/480_296_0/t01f658bda8d6cbf70e.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="左程云算法课笔记"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/03/30/%E5%B7%A6%E7%A8%8B%E4%BA%91%E7%AE%97%E6%B3%95%E8%AF%BE%E7%AC%94%E8%AE%B0/" title="左程云算法课笔记">左程云算法课笔记</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-30T07:30:49.000Z" title="发表于 2023-03-30 15:30:49">2023-03-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%AE%97%E6%B3%95/">算法</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E7%AE%97%E6%B3%95/">算法</a></span></div><div class="content">认识复杂度和简单排序算法
异或运算
无进位的二进制加法
$N \bigoplus 0 = N, N \bigoplus N = 0$


排序算法实现简单选择排序算法
认识O(NlogN)的排序归并排序
小和问题
问题描述：
在一个数组中，每一个数左边比当前数小的数累加起来，叫做这个数组的小和。求一个数组的小和。
题解：


1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253/** * @brief 小和问题 *  * 将小和问题转化为找某数字 num 右侧有多少更大的数字，num 对应的小和就是 num * cnt。 * 在归并排序的基础上，合并数组时查找右侧比左侧大的数字个数，当前left对应数字的小和为 (right - j + 1) * nums[j] */class Solution &#123;public:    int smallSum(vector&lt;int&gt;&amp; nums) &#123;        int ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/03/30/%E4%BA%8C%E5%8F%89%E6%A0%91%E9%81%8D%E5%8E%86%E7%AE%97%E6%B3%95/" title="二叉树遍历算法"><img class="post-bg" src="http://browser9.qhimg.com/bdm/960_593_0/t0128e904ff207c846b.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="二叉树遍历算法"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/03/30/%E4%BA%8C%E5%8F%89%E6%A0%91%E9%81%8D%E5%8E%86%E7%AE%97%E6%B3%95/" title="二叉树遍历算法">二叉树遍历算法</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-30T07:29:15.000Z" title="发表于 2023-03-30 15:29:15">2023-03-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%AE%97%E6%B3%95/">算法</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E6%A0%91%E7%9A%84%E9%81%8D%E5%8E%86/">树的遍历</a></span></div><div class="content">前序遍历递归非递归1234567891011121314151617181920212223242526class Solution &#123;public:    vector&lt;int&gt; preorderTraversal(TreeNode* root) &#123;        if(!root) &#123;            return vector&lt;int&gt;();        &#125;                stack&lt;TreeNode*&gt; S;        vector&lt;int&gt; preOrder;        TreeNode* p = root;                while(!S.empty() || p) &#123;            while(p) &#123;                preOrder.emplace_back(p-&gt;val);                S.emplace(p);                p = p-&gt;le ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/03/30/%E5%B9%B6%E6%9F%A5%E9%9B%86/" title="并查集"><img class="post-bg" src="http://browser9.qhimg.com/bdm/480_296_0/t01a78941bc25ae2cf9.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="并查集"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/03/30/%E5%B9%B6%E6%9F%A5%E9%9B%86/" title="并查集">并查集</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-30T07:27:42.000Z" title="发表于 2023-03-30 15:27:42">2023-03-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%AE%97%E6%B3%95/">算法</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E5%B9%B6%E6%9F%A5%E9%9B%86/">并查集</a></span></div><div class="content">实现包括路径压缩与按秩合并
12345678910111213141516171819202122232425262728293031323334353637class UnionFind &#123;public:    UnionFind(int n) &#123;        f.assign(n + 1, 0);        rank.assign(n + 1, 1);        for(int i = 0; i &lt;= n; i++) &#123;            f[i] = i;        &#125;    &#125;    int find(int x) &#123;        return x == f[x] ? x : (f[x] = find(f[x]));    &#125;    // 函数名不能用union，会与c++关键字冲突    void merge(int a, int b) &#123;        int x = find(a), y = find(b);        if(rank[x] &lt;= rank[ ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/03/30/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/" title="操作系统基础"><img class="post-bg" src="http://browser9.qhimg.com/bdm/960_593_0/t01846b3cf9202caed4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="操作系统基础"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/03/30/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/" title="操作系统基础">操作系统基础</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-30T07:25:57.000Z" title="发表于 2023-03-30 15:25:57">2023-03-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a></span></div><div class="content">基础进程上下文：进程的当前运行状态，包括程序计数器、通用寄存器、浮点寄存器、状态寄存器、用户栈、内核数据结构（页表、进程表、文件表）等
线程和进程的区别？

调度：线程是调度的基本单位（PC，状态码，通用寄存器，线程栈及栈指针）；进程是拥有资源的基本单位（打开文件，堆，静态区，代码段等）。

并发性：一个进程内多个线程可以并发（最好和CPU核数相等）；多个进程可以并发。

拥有资源：线程不拥有系统资源，但一个进程的多个线程可以共享隶属进程的资源；进程是拥有资源的独立单位。

系统开销：线程创建销毁只需要处理PC值，状态码，通用寄存器值，线程栈及栈指针即可；进程创建和销毁需要重新分配及销毁task_struct结构。

子进程从父进程继承的内容

用户号UIDs和用户组号GIDs
环境Environment
堆栈
共享内存
打开文件的描述符
执行时关闭（Close-on-exec）标志
信号（Signal）控制设定
进程组号
当前工作目录
根目录
文件方式创建屏蔽字
资源限制
控制终端


子进程独有

进程号PID
不同的父进程号
自己的文件描述符和目录流的拷贝
子进程不继承父进程的进 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/03/30/STL%E7%A9%BA%E9%97%B4%E9%85%8D%E7%BD%AE%E5%99%A8/" title="STL空间配置器"><img class="post-bg" src="http://cdn-hw-static.shanhutech.cn/bizhi/staticwp/202212/d74da9edd43874e8dd4df6b51ba60254--2856100756.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="STL空间配置器"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/03/30/STL%E7%A9%BA%E9%97%B4%E9%85%8D%E7%BD%AE%E5%99%A8/" title="STL空间配置器">STL空间配置器</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-30T07:23:42.000Z" title="发表于 2023-03-30 15:23:42">2023-03-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/STL/">STL</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/STL/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/">内存管理</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/STL/">STL</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/">内存管理</a></span></div><div class="content">考虑到小型区块可能造成的内存破碎问题，SGI 为此设计了双层级配置器。

当配置区块超过 128bytes 时，称为足够大，使用第一级配置器malloc_alloc_template，直接使用 malloc() 和 free()。 
当配置区块不大于 128bytes 时，为了降低额外负担，直接使用第二级配置器default_alloc_template，采用复杂的 memory pool 处理方式。



维护16条链表，分别是0-15号链表，最小8字节，以8字节逐渐递增，最大128字节，传入一个字节参数，表示需要多大的内存，会自动校对到第几号链表（如需要13bytes空间，会分配 16bytes），在找到第n个链表后查看链表是否为空，如果不为空直接从对应的free_list中取出，将已经取出的指针向后移动一位。

若对应的free_list为空，先看其内存池是不是空时，如果内存池不为空： 
 （1）先检验它剩余空间是否够20个节点大小（即所需内存大小(提升后) * 20），若足够则直接从内存池 中拿出20个节点大小空间，将其中一个分配给用户使用，另外19个当作自由链表中的区块挂在相 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/03/30/malloc%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86/" title="malloc底层实现原理"><img class="post-bg" src="http://cdn-hw-static.shanhutech.cn/bizhi/staticwp/202301/c6c2f1e7537abae1dddb32dcc4dc94da--3750712376.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="malloc底层实现原理"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/03/30/malloc%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86/" title="malloc底层实现原理">malloc底层实现原理</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-30T07:22:00.000Z" title="发表于 2023-03-30 15:22:00">2023-03-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/c/">c++</a><i class="fas fa-angle-right article-meta-link"></i><a class="article-meta__categories" href="/categories/c/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/">内存管理</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/malloc/">malloc</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86/">实现原理</a></span></div><div class="content">Ref：linux环境内存分配原理
实现方式
当开辟的空间小于 128K 时，调用 brk()函数，malloc 的底层实现是系统调用函数 brk()，其主要移动指针 _enddata（此时的 _enddata 指的是 Linux 地址空间中堆段的末尾地址，不是数据段的末尾地址）
当开辟的空间大于 128K 时，mmap()系统调用函数来在虚拟地址空间中（堆和栈中间，称为“文件映射区域”的地方）找一块空间来开辟。

两种方式都是分配虚拟内存，没有分配物理内存。只有在第一次访问已分配的虚拟空间时，发生缺页中断，操作系统负责分配物理内存，并建立虚拟内存与物理内存的映射。
小于128K

大于128K

free空间


使用brk()分配的内存空间，只有在高地址内存释放以后才能释放。如图（7），B释放以后，由于_edata指针之前还有D存在，因此B无法被释放，其物理内存和虚拟内存均无法被释放，但可以被重用（新请求40K，便可以分配该内存块）
使用mmap()分配的内存空间，可以使用munmap()释放，且可以被单独释放
当最高地址空间的空闲内存超过128K（可由M_TRIM_THRESHO ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/03/30/C++%E8%BF%90%E7%AE%97%E7%AC%A6%E9%87%8D%E8%BD%BD/" title="C++运算符重载"><img class="post-bg" src="http://cdn-hw-static.shanhutech.cn/bizhi/staticwp/202302/5ccf4ce9f65b075e980a4bd3587a68f6--1444630449.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="C++运算符重载"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/03/30/C++%E8%BF%90%E7%AE%97%E7%AC%A6%E9%87%8D%E8%BD%BD/" title="C++运算符重载">C++运算符重载</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-30T07:20:06.000Z" title="发表于 2023-03-30 15:20:06">2023-03-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/C/">C++</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/C/">C++</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E9%87%8D%E8%BD%BD/">重载</a></span></div><div class="content">function call ()12345678910111213141516171819class LessThan &#123;public:    bool operator()(const int&amp; num) &#123;        return num &lt; 5;    &#125;&#125;;int main() &#123;    vector&lt;int&gt; nums&#123;1, 2, 7, 4, 6, 3&#125;;    auto mycmp = [](const int&amp; a) &#123;return a &lt; 6;&#125;;    auto it1 = find_if(nums.begin(), nums.end(), mycmp);    auto it2 = find_if(nums.begin(), nums.end(), LessThan());    cout &lt;&lt; *it1 &lt;&lt; endl;    cout &lt;&lt; *it2 &lt;&lt; endl;    retu ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/03/30/C++%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88/" title="C++函数指针"><img class="post-bg" src="http://cdn-hw-static.shanhutech.cn/bizhi/staticwp/202208/602572f742ea665fb55e1691954ce09b--889050502.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="C++函数指针"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/03/30/C++%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88/" title="C++函数指针">C++函数指针</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-30T07:18:44.000Z" title="发表于 2023-03-30 15:18:44">2023-03-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/C/">C++</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/C/">C++</a></span></div><div class="content">函数指针为方便调用具有相同格式（包括返回类型与参数列表）的函数，使用函数指针指向对应的函数，以调用该函数。
例如，目前有以下几个函数：
123string fun_a(int x) &#123;&#125;string fun_b(int x) &#123;&#125;string fun_c(int x) &#123;&#125;

为方便调用以上函数，需要定义函数指针，其类型需要指明函数的返回值与参数列表，如下：
string (*func_pointer)(int)，表示返回值类型为string，参数列表为（int），该指针的名称为func_pointer，类型为string (*)(int)。
用法将函数地址复制给函数指针即可，例如：
赋值：func_pointer = fun_a;，调用：func_pointer(num);

函数指针数组为方便循环调用以上函数，需要用到函数指针数组，如：string (*func_pointer[])(int)，即在函数指针的类型上添加[]表示数组。
用法1string (*funcs[])(int) = &#123;fun_a, fun_ ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/03/30/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" title="多线程"><img class="post-bg" src="http://browser9.qhimg.com/bdm/960_593_0/t0128e904ff207c846b.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="多线程"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/03/30/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" title="多线程">多线程</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-03-30T07:16:48.000Z" title="发表于 2023-03-30 15:16:48">2023-03-30</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B/">多线程</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/C/">C++</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/">多线程</a></span></div><div class="content">
不加锁实现线程安全
atomic

threadlocal：每个线程的对象共享数据，不同线程相互隔离，相当于线程内的static变量；threadlocal变量与线程绑定，和线程具有相同的生命周期，且只有第一次声明时被赋值。作用域仍然与普通变量相同。
  Ref：C++11 thread_local用法、C++ 11 关键字：thread_local

CAS：CAS操作包含三个操作数——内存位置（V）、预期原值（A）、新值(B)。如果内存位置的值与预期原值相匹配，那么处理器会自动将该位置值更新为新值。否则，处理器不做任何操作。




无论哪种情况，它都会在CAS指令之前返回该位置的值。CAS有效地说明了“我认为位置V应该包含值A；如果包含该值，则将B放到这个位置；否则，不要更改该位置，只告诉我这个位置现在的值即可”。
    Ref：[锁机制及CAS实现原理(C++) ](https://zhuanlan.zhihu.com/p/400817892)

    

无锁数据结构
  迈向多线程——解析无锁队列的原理与实现
几种典型的锁互斥锁5.2 互斥量
条件变量5.3 条件变量 ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/#content-inner">2</a><a class="extend next" rel="next" href="/page/2/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/niliushall.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">niliushall</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/niliushall"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/niliushall" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:niliushall@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">个人博客，记录日常学习内容</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/03/30/Python%E6%97%A5%E5%BF%97%E5%BA%93logging/" title="Python日志库logging"><img src="http://cdn-hw-static.shanhutech.cn/bizhi/staticwp/202212/13746e6880e009d49378a81f0dec5474--569975149.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python日志库logging"/></a><div class="content"><a class="title" href="/2023/03/30/Python%E6%97%A5%E5%BF%97%E5%BA%93logging/" title="Python日志库logging">Python日志库logging</a><time datetime="2023-03-30T07:33:05.000Z" title="发表于 2023-03-30 15:33:05">2023-03-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/03/30/%E5%B7%A6%E7%A8%8B%E4%BA%91%E7%AE%97%E6%B3%95%E8%AF%BE%E7%AC%94%E8%AE%B0/" title="左程云算法课笔记"><img src="http://browser9.qhimg.com/bdm/480_296_0/t01f658bda8d6cbf70e.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="左程云算法课笔记"/></a><div class="content"><a class="title" href="/2023/03/30/%E5%B7%A6%E7%A8%8B%E4%BA%91%E7%AE%97%E6%B3%95%E8%AF%BE%E7%AC%94%E8%AE%B0/" title="左程云算法课笔记">左程云算法课笔记</a><time datetime="2023-03-30T07:30:49.000Z" title="发表于 2023-03-30 15:30:49">2023-03-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/03/30/%E4%BA%8C%E5%8F%89%E6%A0%91%E9%81%8D%E5%8E%86%E7%AE%97%E6%B3%95/" title="二叉树遍历算法"><img src="http://browser9.qhimg.com/bdm/960_593_0/t0128e904ff207c846b.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="二叉树遍历算法"/></a><div class="content"><a class="title" href="/2023/03/30/%E4%BA%8C%E5%8F%89%E6%A0%91%E9%81%8D%E5%8E%86%E7%AE%97%E6%B3%95/" title="二叉树遍历算法">二叉树遍历算法</a><time datetime="2023-03-30T07:29:15.000Z" title="发表于 2023-03-30 15:29:15">2023-03-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/03/30/%E5%B9%B6%E6%9F%A5%E9%9B%86/" title="并查集"><img src="http://browser9.qhimg.com/bdm/480_296_0/t01a78941bc25ae2cf9.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="并查集"/></a><div class="content"><a class="title" href="/2023/03/30/%E5%B9%B6%E6%9F%A5%E9%9B%86/" title="并查集">并查集</a><time datetime="2023-03-30T07:27:42.000Z" title="发表于 2023-03-30 15:27:42">2023-03-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/03/30/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/" title="操作系统基础"><img src="http://browser9.qhimg.com/bdm/960_593_0/t01846b3cf9202caed4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="操作系统基础"/></a><div class="content"><a class="title" href="/2023/03/30/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/" title="操作系统基础">操作系统基础</a><time datetime="2023-03-30T07:25:57.000Z" title="发表于 2023-03-30 15:25:57">2023-03-30</time></div></div></div></div><div class="card-widget" id="card-newest-comments"><div class="item-headline"><i class="fas fa-comment-dots"></i><span>最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/C/"><span class="card-category-list-name">C++</span><span class="card-category-list-count">4</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/C/%E6%B7%B1%E5%85%A5%E5%BA%94%E7%94%A8C-11/"><span class="card-category-list-name">深入应用C++11</span><span class="card-category-list-count">2</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/"><span class="card-category-list-name">Java</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Python/"><span class="card-category-list-name">Python</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/STL/"><span class="card-category-list-name">STL</span><span class="card-category-list-count">1</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/STL/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/"><span class="card-category-list-name">内存管理</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/c/"><span class="card-category-list-name">c++</span><span class="card-category-list-count">1</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/c/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/"><span class="card-category-list-name">内存管理</span><span class="card-category-list-count">1</span></a></li></ul></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86/" style="font-size: 1.1em; color: #999">实现原理</a> <a href="/tags/%E6%A0%91%E7%9A%84%E9%81%8D%E5%8E%86/" style="font-size: 1.1em; color: #999">树的遍历</a> <a href="/tags/Java/" style="font-size: 1.1em; color: #999">Java</a> <a href="/tags/%E6%B7%B1%E5%85%A5%E5%BA%94%E7%94%A8C-11/" style="font-size: 1.3em; color: #99a1ac">深入应用C++11</a> <a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 1.1em; color: #999">操作系统</a> <a href="/tags/C/" style="font-size: 1.5em; color: #99a9bf">C++</a> <a href="/tags/DevStack/" style="font-size: 1.1em; color: #999">DevStack</a> <a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 1.3em; color: #99a1ac">多线程</a> <a href="/tags/C-11/" style="font-size: 1.3em; color: #99a1ac">C++11</a> <a href="/tags/Python/" style="font-size: 1.1em; color: #999">Python</a> <a href="/tags/OpenStack/" style="font-size: 1.1em; color: #999">OpenStack</a> <a href="/tags/malloc/" style="font-size: 1.1em; color: #999">malloc</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" style="font-size: 1.1em; color: #999">网络编程</a> <a href="/tags/%E5%B9%B6%E6%9F%A5%E9%9B%86/" style="font-size: 1.1em; color: #999">并查集</a> <a href="/tags/%E9%87%8D%E8%BD%BD/" style="font-size: 1.1em; color: #999">重载</a> <a href="/tags/logging/" style="font-size: 1.1em; color: #999">logging</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 1.1em; color: #999">算法</a> <a href="/tags/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/" style="font-size: 1.1em; color: #999">内存管理</a> <a href="/tags/STL/" style="font-size: 1.1em; color: #999">STL</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/03/"><span class="card-archive-list-date">三月 2023</span><span class="card-archive-list-count">14</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">14</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2022-06-03T00:00:00.000Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">20.5k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2023-03-30T08:07:19.533Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/img/index.png')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By niliushall</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>window.typedJSFn = {
  init: (str) => {
    window.typed = new Typed('#subtitle', Object.assign({
      strings: str,
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50,
    }, null))
  },
  run: (subtitleType) => {
    if (true) {
      if (typeof Typed === 'function') {
        subtitleType()
      } else {
        getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
      }
    } else {
      subtitleType()
    }
  }
}
</script><script>function subtitleType () {
  if (true) {
    typedJSFn.init(["流沙聚散&#44;谁主沉浮"])
  } else {
    document.getElementById("subtitle").innerHTML = '流沙聚散&#44;谁主沉浮'
  }
}
typedJSFn.run(subtitleType)</script><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5/js/md5.min.js"></script><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getIcon = (icon, mail) => {
    if (icon) return icon
    let defaultIcon = '?d=monsterid'
    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`
    return iconUrl
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }

        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick} / </span><time datetime="${array[i].date}">${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const getComment = () => {
    const serverURL = 'https://2BW0j2qF.api.lncldglobal.com'

    var settings = {
      "method": "GET",
      "headers": {
        "X-LC-Id": '2BW0j2qFwhrxHDKP8l7iJ2JW-gzGzoHsz',
        "X-LC-Key": 'C3MwlIx71Mqyu6T1No9CT5LZ',
        "Content-Type": "application/json"
      },
    }

    fetch(`${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,settings)
      .then(response => response.json())
      .then(data => {
        const valineArray = data.results.map(function (e) {
          return {
            'avatar': getIcon(e.QQAvatar, e.mail),
            'content': changeContent(e.comment),
            'nick': e.nick,
            'url': e.url + '#' + e.objectId,
            'date': e.updatedAt,
          }
        })
        saveToLocal.set('valine-newest-comments', JSON.stringify(valineArray), 10/(60*24))
        generateHtml(valineArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "无法获取评论，请确认相关配置是否正确"
      }) 
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('valine-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></body></html>